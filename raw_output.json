{"version":"1.124.0","results":[{"check_id":"semgrep.express-weak-jwt-secret","path":"server/middleware/auth.js","start":{"line":12,"col":43,"offset":319},"end":{"line":12,"col":86,"offset":362},"extra":{"metavars":{"$FALLBACK":{"start":{"line":12,"col":69,"offset":345},"end":{"line":12,"col":86,"offset":362},"abstract_content":"'your-secret-key'"}},"message":"Hardcoded JWT secret fallback detected","metadata":{"category":"security","owasp":"A02:2021 - Cryptographic Failures"},"severity":"ERROR","fingerprint":"3ea9c7bb3c80ad3cf2e5b51c1654adff2c9287f43f08ab1b60bb9042e206cb5bee370139af3e321fa3a700702a088522a46d0e56ec947e19ec6063dd13973c49_0","lines":"        const decoded = jwt.verify(token, process.env.JWT_SECRET || 'your-secret-key');","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.express-unencrypted-password-comparison","path":"server/middleware/vulnerable-auth.js","start":{"line":12,"col":15,"offset":414},"end":{"line":15,"col":10,"offset":533},"extra":{"metavars":{"$QUERY":{"start":{"line":12,"col":15,"offset":414},"end":{"line":12,"col":20,"offset":419},"abstract_content":"query"},"$PASSWORD":{"start":{"line":14,"col":23,"offset":479},"end":{"line":14,"col":31,"offset":487},"abstract_content":"password"}},"message":"Potential unencrypted password comparison in query","metadata":{"category":"security","owasp":"A02:2021 - Cryptographic Failures"},"severity":"ERROR","fingerprint":"b9665be9dfaadaad0613e967df3448e97f4451bfb8cb096d103325d2e4d6ba6a57c5af594a83208610b550d05ba2da61a1062d799d30e554d22e967826fc9e74_0","lines":"        const query = { \n            username: username,\n            password: password  // Unencrypted password comparison\n        };","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.express-sensitive-data-exposure","path":"server/middleware/vulnerable-auth.js","start":{"line":29,"col":9,"offset":975},"end":{"line":34,"col":10,"offset":1160},"extra":{"metavars":{"$DATA":{"start":{"line":33,"col":23,"offset":1110},"end":{"line":33,"col":36,"offset":1123},"abstract_content":"user.password"}},"message":"Sensitive data (password) exposure in response/session","metadata":{"category":"security","owasp":"A02:2021 - Cryptographic Failures"},"severity":"ERROR","fingerprint":"719e027533d8d775137770917df48ec8af8813c1c510f5e8c9922685c1e73c7a0254d4df1a842ba175e9dd6ff59422e4c438e69e4d79b0cd826b934998e43cf2_0","lines":"        req.session.user = {\n            id: user._id,\n            username: user.username,\n            role: user.role,\n            password: user.password // Exposing sensitive data\n        };","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.express-unencrypted-password-comparison","path":"server/middleware/vulnerable-auth.js","start":{"line":29,"col":9,"offset":975},"end":{"line":34,"col":10,"offset":1160},"extra":{"metavars":{"$QUERY":{"start":{"line":29,"col":9,"offset":975},"end":{"line":29,"col":25,"offset":991},"abstract_content":"req.session.user"},"$PASSWORD":{"start":{"line":33,"col":23,"offset":1110},"end":{"line":33,"col":36,"offset":1123},"abstract_content":"user.password"}},"message":"Potential unencrypted password comparison in query","metadata":{"category":"security","owasp":"A02:2021 - Cryptographic Failures"},"severity":"ERROR","fingerprint":"27d032b67b722f89d687c02e3e8c718fff8143b0ffa6827d1d6f26193dc869862d214bf0cc9a0c9ee23f9228fd140fad25e4be196fae524d518648648807b14c_0","lines":"        req.session.user = {\n            id: user._id,\n            username: user.username,\n            role: user.role,\n            password: user.password // Exposing sensitive data\n        };","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.express-unsafe-role-check","path":"server/middleware/vulnerable-auth.js","start":{"line":50,"col":8,"offset":1566},"end":{"line":50,"col":36,"offset":1594},"extra":{"metavars":{},"message":"Unsafe admin role check using query parameters","metadata":{"category":"security","owasp":"A01:2021 - Broken Access Control"},"severity":"ERROR","fingerprint":"ef13aa49c5f4febcf452b3ddc1e007cb505f8d30e4b23e448c853080ce1b2056fd309ef5b051b6d53ebfd203157ca87705f8b740f7684907717642b6fe26859b_0","lines":"    if (req.query.role === 'admin') {","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.express-nosql-injection-findone","path":"server/routes/auth.js","start":{"line":25,"col":30,"offset":797},"end":{"line":25,"col":53,"offset":820},"extra":{"metavars":{"$MODEL":{"start":{"line":25,"col":30,"offset":797},"end":{"line":25,"col":34,"offset":801},"abstract_content":"User"},"$FIELD":{"start":{"line":25,"col":45,"offset":812},"end":{"line":25,"col":50,"offset":817},"abstract_content":"email"},"$INPUT":{"start":{"line":25,"col":45,"offset":812},"end":{"line":25,"col":50,"offset":817},"abstract_content":"email"}},"message":"Potential NoSQL injection via unvalidated input in query","metadata":{"category":"security","owasp":"A03:2021 - Injection"},"severity":"ERROR","fingerprint":"b0d5166c339676a05e8498a216b47b46992e87d021fd508308477f9ea33faed27ab9f10d864897d44b951a4efdedabfa153259a15efa97cac6e868f48072c66a_0","lines":"            let user = await User.findOne({ email });","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.express-weak-jwt-secret","path":"server/routes/auth.js","start":{"line":42,"col":17,"offset":1246},"end":{"line":42,"col":60,"offset":1289},"extra":{"metavars":{"$FALLBACK":{"start":{"line":42,"col":43,"offset":1272},"end":{"line":42,"col":60,"offset":1289},"abstract_content":"'your-secret-key'"}},"message":"Hardcoded JWT secret fallback detected","metadata":{"category":"security","owasp":"A02:2021 - Cryptographic Failures"},"severity":"ERROR","fingerprint":"46936e416efa6b8c927e1ec90c7470bfdbfe1eb56418492ffaf23c0eecf2f8771d16e202bdffc3f804ea667d38027e624d116f0f0348c9a76080fb9e003fe8ba_0","lines":"                process.env.JWT_SECRET || 'your-secret-key',","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.express-nosql-injection-findone","path":"server/routes/auth.js","start":{"line":77,"col":32,"offset":2189},"end":{"line":77,"col":55,"offset":2212},"extra":{"metavars":{"$MODEL":{"start":{"line":77,"col":32,"offset":2189},"end":{"line":77,"col":36,"offset":2193},"abstract_content":"User"},"$FIELD":{"start":{"line":77,"col":47,"offset":2204},"end":{"line":77,"col":52,"offset":2209},"abstract_content":"email"},"$INPUT":{"start":{"line":77,"col":47,"offset":2204},"end":{"line":77,"col":52,"offset":2209},"abstract_content":"email"}},"message":"Potential NoSQL injection via unvalidated input in query","metadata":{"category":"security","owasp":"A03:2021 - Injection"},"severity":"ERROR","fingerprint":"b0d5166c339676a05e8498a216b47b46992e87d021fd508308477f9ea33faed27ab9f10d864897d44b951a4efdedabfa153259a15efa97cac6e868f48072c66a_1","lines":"            const user = await User.findOne({ email });","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.express-weak-jwt-secret","path":"server/routes/auth.js","start":{"line":91,"col":17,"offset":2678},"end":{"line":91,"col":60,"offset":2721},"extra":{"metavars":{"$FALLBACK":{"start":{"line":91,"col":43,"offset":2704},"end":{"line":91,"col":60,"offset":2721},"abstract_content":"'your-secret-key'"}},"message":"Hardcoded JWT secret fallback detected","metadata":{"category":"security","owasp":"A02:2021 - Cryptographic Failures"},"severity":"ERROR","fingerprint":"46936e416efa6b8c927e1ec90c7470bfdbfe1eb56418492ffaf23c0eecf2f8771d16e202bdffc3f804ea667d38027e624d116f0f0348c9a76080fb9e003fe8ba_1","lines":"                process.env.JWT_SECRET || 'your-secret-key',","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep.express-nosql-injection-findone","path":"server/routes/transactions.js","start":{"line":84,"col":36,"offset":2496},"end":{"line":84,"col":76,"offset":2536},"extra":{"metavars":{"$MODEL":{"start":{"line":84,"col":36,"offset":2496},"end":{"line":84,"col":47,"offset":2507},"abstract_content":"Transaction"},"$FIELD":{"start":{"line":84,"col":55,"offset":2515},"end":{"line":84,"col":59,"offset":2519},"abstract_content":"user"},"$INPUT":{"start":{"line":84,"col":61,"offset":2521},"end":{"line":84,"col":73,"offset":2533},"abstract_content":"req.user._id"}},"message":"Potential NoSQL injection via unvalidated input in query","metadata":{"category":"security","owasp":"A03:2021 - Injection"},"severity":"ERROR","fingerprint":"164ceb055eb1c205cc525b0380772ec567d45b872c5894717989f51c67ba03fd0a89bc4037cc7ee29a0762c83b8f0727ebbdcf52b73734e2aca7640fbf57263b_0","lines":"        const transactions = await Transaction.find({ user: req.user._id })","is_ignored":false,"validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["client/src/App.test.tsx","client/src/App.tsx","client/src/context/AuthContext.tsx","client/src/index.tsx","client/src/pages/AdminDashboard.tsx","client/src/pages/Dashboard.tsx","client/src/pages/Login.tsx","client/src/pages/Register.tsx","client/src/react-app-env.d.ts","client/src/reportWebVitals.ts","client/src/services/api.ts","client/src/setupTests.ts","server/index.js","server/middleware/auth.js","server/middleware/vulnerable-auth.js","server/models/Transaction.js","server/models/User.js","server/routes/auth.js","server/routes/transactions.js"]},"interfile_languages_used":[],"skipped_rules":[]}
